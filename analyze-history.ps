# powershell script, starts from very beginning
# better use analyze-history.sh
$settingsfile = "lucene.properties"
$startFromSha = "eb0ab3d392a42c1835f79bcd7f5404bcc50c8e4c"
#get all revisions
$fullLog = git log --pretty=format:"%H %cn %cd" --date=short
[array]::Reverse($fullLog)
# for each revision:
foreach($entry in $fullLog) {
  #read git log entry
  $log = $entry.Split(" ")
  $sha = $log[0]
  $date = $log[$log.Length-1]
  #checkout revision
  git stash save
  git checkout -f $sha
  git stash pop
  #analyze
  echo $entry
  if ($sha.Equals("eb0ab3d392a42c1835f79bcd7f5404bcc50c8e4c")) {
    $settingsfile = "lucene2012.properties"
	}
  sonar-scanner -D project.settings=$settingsfile -D sonar.projectDate=$date
}


